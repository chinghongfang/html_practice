<!DOCTYPE html>
<html style="height:100%;">
<head>
	<title>Hello World!</title>
	<meta charset="utf-8">
	
	<link href="style/style.css" rel="stylesheet" type="text/css"><!---->
	<link rel="stylesheet" href="https://unpkg.com/swiper/css/swiper.css">
	<link rel="stylesheet" href="https://unpkg.com/swiper/css/swiper.min.css">
	
</head>
<body style="height:100%;">
	<div style="height:100%;margin:0px;"><!--vertical-align:middle;top:5%;position:absolute;-->
		<div style="height:20%;margin:5%;">
			<div style="height:100%;width:70%;float:left;">
				<input type="text" id="ans" value=""  style="width:90%;height:100%;font-size:100px;">
			</div>
			
			<div style="height:100%;float:left;">
				<!--<button type="button" style="height:100%;" onclick=Go()><image src="image/client2.png" style="width:auto;height:auto;max-width:100%;max-height:100%;"></button>
				-->
				<input type="image" src="image/client2.png" style="max-height:100%;" onclick=Go()></input>
				
			</div>
		</div>
		<div><p id="warningMsg"></p></div>
	
	
		<div class="swiper-container" style="height:20%;">
			<!-- Additional required wrapper -->
			<div class="swiper-wrapper" style="vertical-align:middle">
				<!-- Slides -->
				<div class="swiper-slide" style="text-align:center">
					<div class="alignMiddle">
					<button type="button" class="symbol" id="epsilon" onclick=symbol("ϵ")>ϵ</button>
					<button type="button" class="symbol" id="delta" onclick=symbol("δ")>δ</button>
					<button type="button" class="symbol" id="Sigma" onclick=symbol("Σ")>Σ</button>
					</div>
				</div>
				<div class="swiper-slide" style="text-align:center">
					<div class="alignMiddle">
					<button type="button" class="symbol" id="Delta" onclick=symbol("Δ")>Δ</button>
					<button type="button" class="symbol" id="pi" onclick=symbol("π")>π</button>
					<button type="button" class="symbol" id="theta" onclick=symbol("θ")>θ</button>
					</div>
				</div>
				<div class="swiper-slide" style="text-align:center">
					<div class="alignMiddle">
					<button type="button" class="symbol" id="forall" onclick=symbol("∀")>∀</button>
					<button type="button" class="symbol" id="zeta" onclick=symbol("ζ")>ζ</button>
					<button type="button" class="symbol" id="xi" onclick=symbol("ξ")>ξ</button>
					</div>
				</div>
			</div>
			<!-- If we need pagination 
			<div class="swiper-pagination"></div>-->

			<!-- If we need navigation buttons -->
			<div class="swiper-button-prev"></div>
			<div class="swiper-button-next"></div>

			<!-- If we need scrollbar 
			<div class="swiper-scrollbar"></div>-->
		</div>
		<style>
			.swiper-container{
				width: 80%;
				height: 100%;
			}
			.alignMiddle {
				height:100%;
			}
			.symbol {
				font-size: 100px;
				width: 10%;
				height:100%;
			}
		</style>
		<div style="height:10%;font-size:50px;">
			顏色：
			<label>
				<input type="radio" name="color" value="#000000" style="cursor:pointer;width:50px;height:50px;" checked>
				<image src="image/black.png" style="cursor:pointer;">
			</label>
			<label>
				<input type="radio" name="color" value="#88C23C" style="cursor:pointer;width:50px;height:50px;">
				<image src="image/green.png">
			</label>
			<label>
				<input type="radio" name="color" value="#D2AD63" style="cursor:pointer;width:50px;height:50px;">
				<image src="image/yellow.png" style="cursor:pointer;">
			</label>
			<label>
				<input type="radio" name="color" value="#171C61" style="cursor:pointer;width:50px;height:50px;">
				<image src="image/blue.png" style="cursor:pointer;">
			</label>
		</div>
	</div>
	
	
	<!--  Here is my real script  -->
	<script>
		function symbol(data){
			//console.log(document.getElementById('ans').value);
			//console.log("Caret at: ", document.getElementById('ans').selectionStart)
			let index = document.getElementById('ans').selectionStart
			let head = document.getElementById('ans').value.slice(0,index)
			let tail = document.getElementById('ans').value.slice(index)
			document.getElementById('ans').value = head.concat(data.concat(tail))
		}
		function text_check_change(){
			let data = document.getElementById('ans').value
			data = data.replace(/ϵ/g, "\\epsilon ")
			data = data.replace(/δ/g, "\\delta ")
			data = data.replace(/Σ/g, "\\Sigma ")
			data = data.replace(/Δ/g, "\\Delta ")
			data = data.replace(/π/g, "\\pi ")
			data = data.replace(/θ/g, "\\theta ")
			data = data.replace(/∀/g, "\\forall ")
			data = data.replace(/ζ/g, "\\zeta ")
			data = data.replace(/ξ/g, "\\xi ")
			return data
		}
		//var ws = new WebSocket("ws:localhost:8888");
	</script>
	
	<script src="https://unpkg.com/swiper/js/swiper.js"></script>
	<script src="https://unpkg.com/swiper/js/swiper.min.js"></script>
	<script>
	  var mySwiper = new Swiper ('.swiper-container', {
		// Optional parameters
		direction: 'horizontal',//'vertical',
		loop: true,

		// If we need pagination
		/*pagination: {
		  el: '.swiper-pagination',
		},*/

		// Navigation arrows
		navigation: {
		  nextEl: '.swiper-button-next',
		  prevEl: '.swiper-button-prev',
		},

		// And if we need scrollbar
		/*scrollbar: {
		  el: '.swiper-scrollbar',
		},*/
	  })
	</script>
	
	<!-- Insert these scripts at the bottom of the HTML, but before you use any Firebase services -->

	<!-- Firebase App (the core Firebase SDK) is always required and must be listed first 
	The original once
	<script src="https://www.gstatic.com/firebasejs/7.6.0/firebase-app.js"></script>-->
	<script src="https://www.gstatic.com/firebasejs/7.6.0/firebase.js"></script>

	<!-- If you enabled Analytics in your project, add the Firebase SDK for Analytics -->
	<script src="https://www.gstatic.com/firebasejs/7.6.0/firebase-analytics.js"></script>

	<!-- Add Firebase products that you want to use -->
	<script src="https://www.gstatic.com/firebasejs/7.6.0/firebase-auth.js"></script>
	<script src="https://www.gstatic.com/firebasejs/7.6.0/firebase-firestore.js"></script>
	<script>
		console.log("1");
	  // Your web app's Firebase configuration
	  var firebaseConfig = {
		apiKey: "AIzaSyBF2uPeIMPhyrmUyKfvTy9n7WkOSI85zmg",
		authDomain: "practice-2334f.firebaseapp.com",
		databaseURL: "https://practice-2334f.firebaseio.com",
		projectId: "practice-2334f",
		storageBucket: "practice-2334f.appspot.com",
		messagingSenderId: "906379530813",
		appId: "1:906379530813:web:f36ce20044f9c8f7111054",
		measurementId: "G-NK01QHSFQT"
	  };
	  // Initialize Firebase
	  firebase.initializeApp(firebaseConfig);
	  firebase.analytics();
	  console.log("2")
		// Get a reference to the database service
		var database = firebase.database();
		console.log("3")
		function Go(){
			handleClick()
			
			let text_to_send = text_check_change()
			
			// send something to server
			var d = new Date();
			let time = d.getTime();
			
			// get color radio box
			let colors = document.getElementsByName('color');
			let color;
			for (let i = 0; i< colors.length; ++i){
				if (colors[i].checked){
					color = colors[i].value;
					break;
				}
			}
			
			firebase.database().ref('/chatroom/'+time).set({
				message: text_to_send,
				color:	color
			});
			
		}
		const handleClick=()=>{

				var data={test:text_check_change(),corlr:43453};

    			fetch( '/response',{
					method:"POST",
					body:JSON.stringify(data),
					headers: new Headers({
            					'Content-Type': 'application/json'
        				})
					 })
    			.then(res => res.json())
    			.then(data => {//i know
          			
    			})
    			.catch(e => {
        			console.log(e);
    			})
  		}
	</script>
</body>
</html>